# 夏夜の怪談 - サウンドノベル

## プロジェクト概要
- **名前**: 夏夜の怪談 - 八つの不思議な物語
- **目標**: 日本の夏の怪談話をインタラクティブなサウンドノベルとして体験できるWebアプリケーション
- **特徴**: 
  - 8つの厳選された日本の怪談話
  - 選択肢による分岐ストーリー
  - 雰囲気のある背景画像とBGM
  - タイプライター効果などの演出システム
  - レスポンシブデザイン

## 開発URL
- **開発サーバー**: https://3000-ijqajjsope6ychu5p8d6o-6532622b.e2b.dev
- **ローカル**: http://localhost:3000

## 収録ストーリー

### 学校の怪談
1. **トイレの花子さん** - 3階の女子トイレに住む少女の霊
2. **13階段の呪い** - 深夜に現れる13段目の階段
3. **音楽室のベートーベン** - 動く肖像画と自動演奏するピアノ

### 海・山・お盆の怪談
4. **海坊主の恐怖** - お盆の海に現れる巨大な黒い影
5. **山の神隠し** - キャンプ場で消えた友人の謎
6. **迎え火の霊** - お盆に現れた謎の老人

### 都市伝説
7. **口裂け女** - マスクの女性の恐怖
8. **テケテケ** - 線路に現れる上半身だけの怪異

## 機能一覧

### 実装済み機能
- ✅ ストーリー選択画面（カテゴリ別表示）
- ✅ ノベルゲームエンジン
- ✅ テキストのタイプライター効果
- ✅ 選択肢による分岐システム
- ✅ 背景画像の動的切り替え
- ✅ BGM・効果音の再生
- ✅ 画面演出効果（シェイク、フラッシュ、フェード）
- ✅ オートプレイ機能
- ✅ スキップ機能
- ✅ 戻る機能（シーン履歴管理）
- ✅ キーボード操作対応（Enter/Space/Escape）
- ✅ レスポンシブデザイン

### 未実装機能
- ⏳ セーブ/ロード機能（Cloudflare KV使用）
- ⏳ 既読管理システム
- ⏳ 全ストーリーの詳細な背景画像
- ⏳ キャラクター立ち絵表示
- ⏳ ストーリー完了率の表示
- ⏳ サウンド設定（音量調整）

## 技術スタック
- **フレームワーク**: Hono (Cloudflare Pages対応)
- **ランタイム**: Cloudflare Workers
- **フロントエンド**: 
  - Vanilla JavaScript
  - TailwindCSS (CDN)
  - Font Awesome Icons
- **ビルドツール**: Vite
- **プロセス管理**: PM2
- **言語**: TypeScript

## データアーキテクチャ
- **ストーリーデータ**: TypeScriptオブジェクト形式で管理
- **シーン構造**: ID基準の連結リスト形式
- **選択肢**: 各シーンに複数の分岐を定義
- **演出データ**: エフェクト配列として各シーンに埋め込み

## ユーザーガイド

### 基本操作
1. トップページで読みたい怪談話を選択
2. ストーリーが始まったら、テキストを読み進める
3. 選択肢が出たら、好きな選択肢をクリック
4. 「次へ」ボタンまたはEnter/Spaceキーで進む
5. 「戻る」ボタンで前のシーンに戻れる
6. Escapeキーまたは物語終了でストーリー選択画面へ

### 便利機能
- **オートモード**: 自動でテキストを進める
- **スキップモード**: テキスト表示を高速化
- **キーボード操作**: Enter/Space（次へ）、Escape（終了）

## 開発コマンド

```bash
# 依存関係のインストール
npm install

# 開発サーバーの起動（PM2使用）
npm run build
pm2 start ecosystem.config.cjs

# ビルド
npm run build

# プレビュー
npm run preview

# PM2でのログ確認
pm2 logs summer-horror-novel --nostream

# サーバーの再起動
pm2 restart summer-horror-novel

# サーバーの停止
pm2 stop summer-horror-novel
```

## プロジェクト構造

```
webapp/
├── src/
│   ├── index.tsx           # メインAPIとHTML
│   └── data/
│       └── stories.ts      # ストーリーデータ
├── public/
│   └── static/
│       ├── js/
│       │   └── novel-engine.js  # ノベルエンジン
│       ├── images/         # 背景画像
│       └── audio/          # BGM・効果音
├── ecosystem.config.cjs    # PM2設定
├── package.json
├── tsconfig.json
├── vite.config.ts
└── wrangler.jsonc         # Cloudflare設定
```

## デプロイメント
- **プラットフォーム**: Cloudflare Pages（予定）
- **ステータス**: 開発中
- **最終更新**: 2025-08-17

## 今後の開発予定
1. Cloudflare KVを使用したセーブ/ロード機能
2. 全ストーリーの詳細な背景画像生成
3. キャラクター立ち絵の追加
4. 効果音の充実
5. Cloudflare Pagesへの本番デプロイ
6. PWA対応（オフラインプレイ）