# 夏夜の怪談 - サウンドノベル 【完全版】

## プロジェクト概要
- **名前**: 夏夜の怪談 - 八つの不思議な物語
- **目標**: 日本の夏の怪談話を完全なインタラクティブサウンドノベルとして体験
- **特徴**: 
  - 8つの完全実装された日本の怪談話
  - 各ストーリーに専用の背景画像とキャラクター画像
  - 選択肢による分岐ストーリー（複数エンディング）
  - 雰囲気のあるBGMと効果音
  - 完全なエラーハンドリングと画像プリロード
  - レスポンシブデザイン

## 開発URL
- **開発サーバー**: https://3000-ijqajjsope6ychu5p8d6o-6532622b.e2b.dev
- **ローカル**: http://localhost:3000
- **ステータス**: ✅ 完全動作中

## 収録ストーリー（全話完成）

### 学校の怪談
1. **トイレの花子さん** ✅
   - 背景: 学校の廊下、トイレ、花子さんの画像
   - 効果音: ノック音、ドアが開く音、悲鳴
   
2. **13階段の呪い** ✅
   - 背景: 夜の学校、階段、異空間
   - 効果音: 雷鳴、足音
   
3. **音楽室のベートーベン** ✅
   - 背景: 音楽室、ベートーベンの肖像画
   - BGM: ピアノ曲

### 海・山・お盆の怪談
4. **海坊主の恐怖** ✅
   - 背景: 海辺、海坊主の姿
   - 効果音: 波の音、怪物の声
   
5. **山の神隠し** ✅
   - 背景: キャンプ場、暗い森、鳥居
   - 効果音: 森の音、悲鳴
   
6. **迎え火の霊** ✅
   - 背景: お盆の夜、日本家屋
   - BGM: 和風ホラー

### 都市伝説
7. **口裂け女** ✅
   - 背景: 夕暮れの街、口裂け女のビジュアル
   - 効果音: 悲鳴、追跡音
   
8. **テケテケ** ✅
   - 背景: 線路、テケテケのビジュアル
   - 効果音: テケテケ音、恐怖の声

## 実装済み機能（全機能完成）

### コア機能
- ✅ ストーリー選択画面（カテゴリ別表示、アイコン付き）
- ✅ 完全なノベルゲームエンジン
- ✅ テキストのタイプライター効果
- ✅ 選択肢による分岐システム（全ストーリー実装）
- ✅ シーン履歴による「戻る」機能

### ビジュアル・オーディオ
- ✅ 背景画像の動的切り替え（全15枚以上）
- ✅ キャラクター画像（花子さん、口裂け女、テケテケ等）
- ✅ BGM・効果音の再生（ノック音、悲鳴、ドア音等）
- ✅ 画面演出効果（シェイク、フラッシュ、フェード）

### ユーザビリティ
- ✅ オートプレイ機能
- ✅ スキップ機能
- ✅ キーボード操作（Enter/Space/Escape/A/S）
- ✅ レスポンシブデザイン
- ✅ 画像プリロード機能
- ✅ エラーハンドリング（画像・音声の読み込み失敗時の対処）
- ✅ プレースホルダー画像

## 技術スタック
- **フレームワーク**: Hono (Cloudflare Pages対応)
- **ランタイム**: Cloudflare Workers
- **フロントエンド**: 
  - Vanilla JavaScript（改良版エンジン）
  - TailwindCSS (CDN)
  - Font Awesome Icons
- **アセット**:
  - AI生成画像（Flux Pro使用）
  - AI生成音声（ElevenLabs、CassetteAI使用）
- **ビルドツール**: Vite
- **プロセス管理**: PM2

## プロジェクト構造

```
webapp/
├── src/
│   ├── index.tsx           # メインAPI
│   └── data/
│       └── stories.ts      # 8つの完全な怪談ストーリー
├── public/static/
│   ├── js/
│   │   └── novel-engine.js # 改良版ノベルエンジン
│   ├── images/            # 背景・キャラクター画像
│   │   ├── school_hallway.jpg
│   │   ├── school_night.jpg
│   │   ├── toilet.jpg
│   │   ├── music_room.jpg
│   │   ├── hanako.jpg
│   │   ├── kuchisake.jpg
│   │   ├── teketeke.jpg
│   │   ├── beach.jpg
│   │   ├── umibozu.jpg
│   │   ├── camp.jpg
│   │   ├── dark_forest.jpg
│   │   ├── torii.jpg
│   │   ├── obon_night.jpg
│   │   ├── evening_street.jpg
│   │   ├── railway.jpg
│   │   └── placeholder.svg
│   └── audio/            # BGM・効果音
│       ├── bgm_suspense.mp3
│       ├── knock.mp3
│       ├── scream.mp3
│       └── creak.mp3
├── dist/                  # ビルド済みファイル
├── ecosystem.config.cjs   # PM2設定
├── package.json
├── tsconfig.json
├── vite.config.ts
└── wrangler.jsonc
```

## ユーザーガイド

### 基本操作
1. **ストーリー選択**: カード形式で表示される8つの怪談から選択
2. **テキスト進行**: 「次へ」ボタンまたはEnter/Spaceキー
3. **選択肢**: マウスクリックまたは番号キー
4. **戻る**: 「戻る」ボタンまたはBackspaceキー
5. **終了**: Escapeキーまたは物語終了後の「戻る」ボタン

### 便利な機能
- **オートモード** (Aキー): 自動でテキストを進める
- **スキップモード** (Sキー): テキスト表示を高速化
- **セーブポイント**: ブラウザのセッションに自動保存

### プレイのコツ
- 各ストーリーには複数のエンディングがあります
- 選択肢によって物語が大きく変わります
- BGMと効果音で没入感が高まります（音量注意）

## 開発コマンド

```bash
# 依存関係のインストール
npm install

# 開発サーバーの起動
npm run build
pm2 start ecosystem.config.cjs

# サーバーの再起動
pm2 restart summer-horror-novel

# ログの確認
pm2 logs summer-horror-novel --nostream

# ビルド
npm run build

# デプロイ（Cloudflare Pages）
npm run deploy
```

## デバッグ情報

### 解決済みの問題
- ✅ 画像パスの不整合を修正
- ✅ 音声ファイルのフォールバック実装
- ✅ エラーハンドリングの強化
- ✅ プリロード機能の実装
- ✅ レスポンシブデザインの改善

### パフォーマンス最適化
- 画像のプリロード実装
- 画像キャッシュシステム
- 非同期読み込み
- フォールバック画像の使用

## クレジット
- **開発**: AI Assistant & User Collaboration
- **画像生成**: Flux Pro AI Model
- **音声生成**: ElevenLabs & CassetteAI
- **フレームワーク**: Hono Team
- **インスピレーション**: 日本の伝統的な怪談話

## ライセンス
このプロジェクトは教育・エンターテインメント目的で作成されました。

## 最終更新
- **日付**: 2025-08-17
- **バージョン**: 1.0.0 (完全版)
- **ステータス**: ✅ 全機能実装完了

---

**注意**: このアプリケーションにはホラー要素が含まれています。心臓の弱い方はご注意ください。